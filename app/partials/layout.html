
<div class="container">
  
  
  <!-- ———————————————— THE ARTICLE COVER -->
  <div class="nothing" ng-repeat-start="a in root.children"></div><div
    class="card a"
    ng-class="{
      opened:a.opened,
      nowed:now.a==$index,
      fadesoft:now.a==$index && now.b!=-1,
      fadeaway:now.a!=$index && now.a!=-1,
      fadedead:now.a!=$index && now.b!=-1}"
    ng-click="clickA(a,$index);">
    <div class="closer"><div>X</div></div>
    <div ng-if="a.title" class="title meta">{{a.title}}</div>
    <div ng-if="a.subtitle" class="subtitle meta">{{a.subtitle}}</div>
    <markdown
      ng-if="a.text"
      class="text"
      ng-class="{important:$first}"
      ng-model="a.text">
    </markdown>
    <div ng-class="{cover:a.img}" back-img="{{a.img}}"></div>
  </div><!-- ———————————————— THE CHILDREN --><div
    ng-repeat="b in a.children"
    ng-if="a.opened"
    class="card b"
    ng-class="{
      last:$last,
      preview:now.b==$index,
      fadesoft:now.b!=$index && now.b!=-1,
      fadedead:now.a!=$parent.$parent.$index}"
    ng-click="clickB(b,$index);">
    <!-- REDIRECT -->
    <a ng-if="b.type=='redirect'" class="redirect" href="{{b.redirect}}" target="_new">
      <div class="info">click to open<br>{{b.redirect}}<br>in a new tab</div>
    </a>
    <!-- IMAGE -->
    <div
      ng-if="b.type=='img'"
      class="img">
      <div
        class="cover"
        back-img="{{b.img}}">
      </div>
    </div>
    <!-- IFRAME -->
    <iframe
      ng-if="b.type=='iframe'"
      class="iframe"
      src="{{b.iframe | allowurl}}" 
      width="100%"
      height="100%"
      frameborder="0"
      webkitallowfullscreen
      mozallowfullscreen
      allowfullscreen>
    </iframe>
    <!-- VIMEO -->
    <iframe
      ng-if="b.type=='vimeo'" class="vimeo"
      src="{{b.vimeo | allowvimeo}}" 
      width="100%"
      height="100%"
      frameborder="0"
      webkitallowfullscreen
      mozallowfullscreen
      allowfullscreen>
    </iframe>
    <!-- TEXT CONTENT -->
    <markdown
      ng-if="b.type=='text'"
      class="text"
      ng-model="b.text">
    </markdown>
  </div><div class="nothing" ng-repeat-end></div>
</div>